# Тема 3. Урок 5. Задание 2. #

## Задание

Для проверки № 3 нужно создать еще один оператор. Он немного отличается от предыдущего. Текст запроса указывается в теле самого оператора, и есть возможность указать пороговые значения для проверки результата работы оператора.

Текст запроса вы получили в предыдущем задании, но на всякий случай мы сохранили его и параметры в подсказке.

Внесите изменения в DAG, который вы сделали в задании предыдущего урока, и добавьте в него шаг с выполнением проверки.

<details>
<summary>Подсказка</summary>

```python
Select count(distinct(customer_id)) from user_order_log;
pass_value = 3 
threshold=0.01

Select count(distinct(customer_id)) from user_activity_log;
pass_value = 3 
threshold=0.01

SQLValueCheckOperator(
    task_id="ХХХ", # идентификатор задачи
    sql="SELECT ХХХ FROM ХХХ", # запрос для проверки
    pass_value=ХХХ, # значение, при котором проверку можно считать успешно пройденной 
    threshold=ХХХ  # идентификатор задачи, процент отклонения от pass_value, в случае если значение отклонить на 1 процент от pass_value, проверка всё равно будет считаться успешно выполненной
)
```
</details>

Сохраните полученный код в realization.py и запустите тест.

---

## Тесты

Для запуска тестов используйте файл `submit.py` в текущей директории.

